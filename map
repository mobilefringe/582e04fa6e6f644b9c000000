<div class="row">
    <div class="trim_screen job_page">
        <h1>Centre Map</h1>
        
        <div class="col-md-4">
            <select id="store_select_container" class="form-control select_store">
                <option disabled selected>Select a Store</option>
                <script id="store_select_template" type="x-tmpl-mustache/text">
                    <option value="store_2632"  id="{{id}}" data-name="{{name}}" data-coords="{{x_coordinate}},{{y_coordinate}}">{{name}}</option>
                </script>
            </select>
        </div>
        <div class="col-md-8">
            <a href="http://uppercanadamall.com/system/site_images/photos/000/019/685/original/UCM16278-May-TearSheet-v6.pdf?1466701128" target="_blank" class="pull-right download_map_btn">Download Map</a>
        </div>
	    
	    <div class="row">
            <div class="map_area">
                <div class="col-md-12" style="margin:0px 0 30px 0;">
                    <div class="map">    
                        <div class="map2" style="height:700px; border: solid 1px gray;">            
                            <img id="map_image" src="{{site.property.map_image_path}}" />        		
                    		<!--{% for store in stores %}  -->
                    		<div class="marker" id="store_{{store.id}}" data-coords="{{x_coordinate | minus:19}}, {{y_coordinate | minus:58}}" style="display:none">
                    			<!--{{ store.name }}-->
                    		</div>	
                    		<!--{% endfor %}-->
                    	</div>
            			
                    </div>	        
            	</div>
            </div>
        </div> 
	    

        
    </div>
</div>

<script>
    $(document).ready(function(){
        function renderAll(){
            var stores = getStoresList();
            console.log(stores);
            renderStoreList('#store_select_container','#store_select_template', stores, "stores");

            $("#png_map").attr("src", getPNGMapURL());
        		$('#png_map').smoothZoom({
        		    height: 496,
        		    width: 619,
        		    initial_ZOOM: 0,
        			zoom_MIN: 0,
        			zoom_MAX: 100,
        			responsive: true,
        		    responsive_maintain_ratio: true,
        			zoom_BUTTONS_SHOW : 'YES',
        			pan_BUTTONS_SHOW : 'NO',
        			pan_LIMIT_BOUNDARY : 'NO',
        			button_ALIGN: "top left",
        			container: 'zoom_container'
        		});
		        show_png_pin(".map_pin_a", "#png_map")
        }

        loadMallDataCached(renderAll); 
    })
</script>