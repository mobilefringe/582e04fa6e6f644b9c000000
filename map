<div class="row">
    <div class="trim_screen job_page">
        <h1>Centre Map</h1>
        
        <div class="col-md-4">
            <select id="store_select_container" class="form-control select_store">
                <option disabled selected>Select a Store</option>
                <script id="store_select_template" type="x-tmpl-mustache/text">
                    <option value='{{svgmap_region}}'>{{name}}</option>
                </script>
            </select>
        </div>
        <div class="col-md-8">
            <a href="http://uppercanadamall.com/system/site_images/photos/000/019/685/original/UCM16278-May-TearSheet-v6.pdf?1466701128" target="_blank" class="pull-right download_map_btn">Download Map</a>
        </div>
        
        <div id="parent_div">
		    <div id="zoom_container_directory"  >
			    <img alt="Ucm_map_1" id="map_image" src="https://www.mallmaverick.com/system/properties/maps/000/000/011/original/ucm_map_1.jpg?1435606610" />
			    <div class="landmarks" data-show-at-zoom="100" data-allow-drag="true"></div>
		    </div>
	    </div>
        
    </div>
</div>

<script>
    $(document).ready(function(){
        init();
        function renderAll(){
            var stores = getStoresList();
            renderStoreList('#store_select_container','#store_select_template', stores, "stores");
            
        
    		$('#map_image').smoothZoom({
    			initial_POSITION: "0 0",
    	    	pan_BUTTONS_SHOW: "NO",
    	    	zoom_OUT_TO_FIT: "NO",
    	     	button_SIZE: 34,
    	        button_ALIGN: "top right",    
    	     	container: 'zoom_container_directory',
    	     	responsive: true,
    	     	responsive_maintain_ratio: false,
    	     	zoom_MAX: 300,
    	     	zoom_MIN: 0
    		});
    	
        	$(".mapper").change(function(e) {
        		var id = "#" + $(this).find(':selected')[0].id;
        		var x_coord = parseInt($(id).attr('data-coords').split(",")[0])+20;
        		var y_coord = parseInt($(id).attr('data-coords').split(",")[1]);
        		var name = $(id).attr('data-name');
        		$('#map_image').smoothZoom('focusTo',{
        			x: x_coord,
        			y: y_coord,
        			zoom: 150,
        			speed: 5
        		});
        		$('#map_image').smoothZoom('removeLandmark')
        		$('#map_image').smoothZoom('addLandmark', 
                    [
                    '<div class="item mark" data-show-at-zoom="0" data-position="'+x_coord+','+y_coord+'">\
                        <div>\
                            <div class="text">\
                            <strong>'+name+'</strong>\
                        </div>\
                        <img src="/assets/map_pin_default.png" width="40px" height="59px" alt="marker" />\
                        </div>\
                    </div>'
                    ]
                );
        	});
        }
        
        function custom_mapper(){
    		var id =  "#";
    		var id_js =  "";
    		document.getElementById(id_js).selected = true
    		var x_coord = parseInt($(id).attr('data-coords').split(",")[0])+20;
    		var y_coord = parseInt($(id).attr('data-coords').split(",")[1]);
    		var name = $(id).attr('data-name');
    		$('#map_image').smoothZoom('focusTo',{
    			x: x_coord,
    			y: y_coord,
    			zoom: 150,
    			speed: 5
    		});
    		$('#map_image').smoothZoom('removeLandmark')
    		$('#map_image').smoothZoom('addLandmark', 
                [
                '<div class="item mark" data-show-at-zoom="0" data-position="'+x_coord+','+y_coord+'">\
                    <div>\
                        <div class="text">\
                        <strong>'+name+'</strong>\
                    </div>\
                    <img src="/assets/map_pin_default.png" width="40px" height="59px" alt="marker" />\
                    </div>\
                </div>'
                ]
            );
    	}
        loadMallDataCached(renderAll); 
        custom_mapper();
    })
</script>